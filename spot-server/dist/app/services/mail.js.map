{"version":3,"sources":["../../../src/app/services/mail.ts"],"names":["nodemailer","aws","Email","path","awsconfig","config","update","secretAccessKey","SecretAccessKey","accessKeyId","AccessKeyID","region","transporter","createTransport","SES","apiVersion","rootPath","join","__dirname","imagePath","email","transport","send","preview","message","attachments","filename","cid","views","options","extension","root"],"mappings":"AAEA,MAAOA,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,GAAP,KAAgB,SAAhB,CACA,MAAOC,CAAAA,KAAP,KAAkB,iBAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,MAAjB,CAGA,MAAOC,CAAAA,SAAP,KAAsB,gBAAtB,CAKAH,GAAG,CAACI,MAAJ,CAAWC,MAAX,CAAkB,CAChBC,eAAe,CAAEH,SAAS,CAACI,eADX,CAEhBC,WAAW,CAAEL,SAAS,CAACM,WAFP,CAGhBC,MAAM,CAAE,WAHQ,CAAlB,EAMA,KAAMC,CAAAA,WAAW,CAAGZ,UAAU,CAACa,eAAX,CAA2B,CAC7CC,GAAG,CAAE,GAAIb,CAAAA,GAAG,CAACa,GAAR,CAAY,CACfC,UAAU,CAAE,YADG,CAAZ,CADwC,CAA3B,CAApB,CAMA,KAAMC,CAAAA,QAAQ,CAAGb,IAAI,CAACc,IAAL,CAAUC,SAAV,CAAqB,WAArB,CAAjB,CACA,KAAMC,CAAAA,SAAS,CAAGhB,IAAI,CAACc,IAAL,CAAUC,SAAV,CAAqB,yBAArB,CAAlB,CAEA,KAAME,CAAAA,KAAK,CAAG,GAAIlB,CAAAA,KAAJ,CAAU,CACtBmB,SAAS,CAAET,WADW,CAEtBU,IAAI,CAAE,IAFgB,CAGtBC,OAAO,CAAE,KAHa,CAItBC,OAAO,CAAE,CAEPC,WAAW,CAAE,CACX,CACEC,QAAQ,CAAE,eADZ,CAEEvB,IAAI,CAAEgB,SAFR,CAGEQ,GAAG,CAAE,UAHP,CADW,CAFN,CAJa,CActBC,KAAK,CAAE,CACLC,OAAO,CAAE,CACPC,SAAS,CAAE,KADJ,CADJ,CAILC,IAAI,CAAEf,QAJD,CAde,CAAV,CAAd,CAsBA,cAAe,CAAEI,KAAF,CAAf","sourcesContent":["// Mail Service\n\nimport nodemailer from 'nodemailer';\nimport aws from 'aws-sdk';\nimport Email from 'email-templates';\nimport path from 'path';\n\n// config\nimport awsconfig from '@config/awskey';\n\n// TODO: move out of sandbox\n// https://docs.aws.amazon.com/ses/latest/DeveloperGuide/request-production-access.html?icmpid=docs_ses_console\n\naws.config.update({\n  secretAccessKey: awsconfig.SecretAccessKey,\n  accessKeyId: awsconfig.AccessKeyID,\n  region: 'us-east-1'\n});\n\nconst transporter = nodemailer.createTransport({\n  SES: new aws.SES({\n    apiVersion: '2010-12-01'\n  })\n});\n\nconst rootPath = path.join(__dirname, '../emails');\nconst imagePath = path.join(__dirname, '../emails/spot_logo.png');\n\nconst email = new Email({\n  transport: transporter,\n  send: true,\n  preview: false,\n  message: {\n    // from: 'test@spot.com',\n    attachments: [\n      {\n        filename: 'spot_logo.png',\n        path: imagePath,\n        cid: 'spotlogo'\n      }\n    ]\n  },\n  views: {\n    options: {\n      extension: 'pug'\n    },\n    root: rootPath\n  }\n});\n\nexport default { email };\n"],"file":"mail.js"}