{"version":3,"sources":["../../../src/app/helpers/rateLimiter.ts"],"names":["rateLimit","RateLimitError","adminTimeout","adminLimit","adminLimiter","windowMs","max","handler","req","res","next","genericNotificationTimeout","genericNotificationLimit","genericNotificationLimiter","genericFriendTimeout","genericFriendLimit","genericFriendLimiter","createPostTimeout","createPostLimit","createPostLimiter","skipFailedRequests","genericPostTimeout","genericPostLimit","genericPostLimiter","createCommentTimeout","createCommentLimit","createCommentLimiter","genericCommentTimeout","genericCommentLimit","genericCommentLimiter","authenticationTimeout","authenticationLimit","authenticationLimiter","skipSuccessfulRequests","passwordResetTimeout","passwordResetLimit","passwordResetLimiter","tokenTimeout","tokenLimit","tokenLimiter","newPasswordTimeout","newPasswordLimit","newPasswordLimiter"],"mappings":"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","sourcesContent":["import rateLimit from 'express-rate-limit';\n\n// See for handler details\n// https://www.npmjs.com/package/express-rate-limit\n\nimport { RateLimitError } from '@exceptions/rateLimit';\n\n\n// The RateLimitError constructor is (code, limit, timeout)\n\n// Admin\nconst adminTimeout = 1; // minutes\nconst adminLimit = 60;\nconst adminLimiter = rateLimit({\n  windowMs: adminTimeout * 60 * 1000,\n  max: adminLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(429, adminLimit, adminTimeout)\n    );\n  }\n});\n\n// Notification Limiters\nconst genericNotificationTimeout = 1; // minutes\nconst genericNotificationLimit = 60;\nconst genericNotificationLimiter = rateLimit({\n  windowMs: genericNotificationTimeout * 60 * 1000,\n  max: genericNotificationLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        genericNotificationLimit,\n        genericNotificationTimeout\n      )\n    );\n  }\n});\n\n// Friend Limiters\nconst genericFriendTimeout = 1; // minutes\nconst genericFriendLimit = 60;\nconst genericFriendLimiter = rateLimit({\n  windowMs: genericFriendTimeout * 60 * 1000,\n  max: genericFriendLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        genericFriendLimit,\n        genericFriendTimeout\n      )\n    );\n  }\n});\n\n// Post Limiters\nconst createPostTimeout = 1; // minutes\nconst createPostLimit = 1;\nconst createPostLimiter = rateLimit({\n  windowMs: createPostTimeout * 60 * 1000,\n  max: createPostLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(429, createPostLimit, createPostTimeout)\n    );\n  },\n  skipFailedRequests: true\n});\n\nconst genericPostTimeout = 1; // minutes\nconst genericPostLimit = 300;\nconst genericPostLimiter = rateLimit({\n  windowMs: genericPostTimeout * 60 * 1000,\n  max: genericPostLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        genericPostLimit,\n        genericPostTimeout\n      )\n    );\n  }\n});\n\n// Comment Limiters\nconst createCommentTimeout = 1; // minutes\nconst createCommentLimit = 5;\nconst createCommentLimiter = rateLimit({\n  windowMs: createCommentTimeout * 60 * 1000,\n  max: createCommentLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        createCommentLimit,\n        createCommentTimeout\n      )\n    );\n  },\n  skipFailedRequests: true\n});\n\nconst genericCommentTimeout = 1; // minutes\nconst genericCommentLimit = 300;\nconst genericCommentLimiter = rateLimit({\n  windowMs: genericCommentTimeout * 60 * 1000,\n  max: genericCommentLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        genericCommentLimit,\n        genericCommentTimeout\n      )\n    );\n  }\n});\n\n// Authentication Limiters\nconst authenticationTimeout = 5; // minutes\nconst authenticationLimit = 10;\nconst authenticationLimiter = rateLimit({\n  windowMs: authenticationTimeout * 60 * 1000,\n  max: authenticationLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        authenticationLimit,\n        authenticationTimeout\n      )\n    );\n  },\n  skipSuccessfulRequests: true\n});\n\nconst passwordResetTimeout = 5; // minutes\nconst passwordResetLimit = 5;\nconst passwordResetLimiter = rateLimit({\n  windowMs: passwordResetTimeout * 60 * 1000,\n  max: passwordResetLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        passwordResetLimit,\n        passwordResetTimeout\n      )\n    );\n  },\n  skipSuccessfulRequests: true\n});\n\nconst tokenTimeout = 5; // minutes\nconst tokenLimit = 5;\nconst tokenLimiter = rateLimit({\n  windowMs: tokenTimeout * 60 * 1000,\n  max: tokenLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(429, tokenLimit, tokenTimeout)\n    );\n  },\n  skipSuccessfulRequests: true\n});\n\nconst newPasswordTimeout = 5; // minutes\nconst newPasswordLimit = 5;\nconst newPasswordLimiter = rateLimit({\n  windowMs: newPasswordTimeout * 60 * 1000,\n  max: newPasswordLimit,\n  handler: function (req: any, res: any, next: any) {\n    return next(\n      new RateLimitError(\n        429,\n        newPasswordLimit,\n        newPasswordTimeout\n      )\n    );\n  },\n  skipSuccessfulRequests: true\n});\n\nexport default {\n  adminLimiter,\n  genericPostLimiter,\n  createCommentLimiter,\n  genericCommentLimiter,\n  createPostLimiter,\n  authenticationLimiter,\n  passwordResetLimiter,\n  tokenLimiter,\n  newPasswordLimiter,\n  genericFriendLimiter,\n  genericNotificationLimiter\n};\n"],"file":"rateLimiter.js"}