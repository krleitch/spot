import rateLimit from"express-rate-limit";import{RateLimitError}from"@exceptions/rateLimit";const adminTimeout=1;const adminLimit=60;const adminLimiter=rateLimit({windowMs:adminTimeout*60*1000,max:adminLimit,handler:function(req,res,next){return next(new RateLimitError(429,adminLimit,adminTimeout))}});const genericNotificationTimeout=1;const genericNotificationLimit=60;const genericNotificationLimiter=rateLimit({windowMs:genericNotificationTimeout*60*1000,max:genericNotificationLimit,handler:function(req,res,next){return next(new RateLimitError(429,genericNotificationLimit,genericNotificationTimeout))}});const genericFriendTimeout=1;const genericFriendLimit=60;const genericFriendLimiter=rateLimit({windowMs:genericFriendTimeout*60*1000,max:genericFriendLimit,handler:function(req,res,next){return next(new RateLimitError(429,genericFriendLimit,genericFriendTimeout))}});const createPostTimeout=1;const createPostLimit=1;const createPostLimiter=rateLimit({windowMs:createPostTimeout*60*1000,max:createPostLimit,handler:function(req,res,next){return next(new RateLimitError(429,createPostLimit,createPostTimeout))},skipFailedRequests:true});const genericPostTimeout=1;const genericPostLimit=300;const genericPostLimiter=rateLimit({windowMs:genericPostTimeout*60*1000,max:genericPostLimit,handler:function(req,res,next){return next(new RateLimitError(429,genericPostLimit,genericPostTimeout))}});const createCommentTimeout=1;const createCommentLimit=5;const createCommentLimiter=rateLimit({windowMs:createCommentTimeout*60*1000,max:createCommentLimit,handler:function(req,res,next){return next(new RateLimitError(429,createCommentLimit,createCommentTimeout))},skipFailedRequests:true});const genericCommentTimeout=1;const genericCommentLimit=300;const genericCommentLimiter=rateLimit({windowMs:genericCommentTimeout*60*1000,max:genericCommentLimit,handler:function(req,res,next){return next(new RateLimitError(429,genericCommentLimit,genericCommentTimeout))}});const authenticationTimeout=5;const authenticationLimit=10;const authenticationLimiter=rateLimit({windowMs:authenticationTimeout*60*1000,max:authenticationLimit,handler:function(req,res,next){return next(new RateLimitError(429,authenticationLimit,authenticationTimeout))},skipSuccessfulRequests:true});const passwordResetTimeout=5;const passwordResetLimit=5;const passwordResetLimiter=rateLimit({windowMs:passwordResetTimeout*60*1000,max:passwordResetLimit,handler:function(req,res,next){return next(new RateLimitError(429,passwordResetLimit,passwordResetTimeout))},skipSuccessfulRequests:true});const tokenTimeout=5;const tokenLimit=5;const tokenLimiter=rateLimit({windowMs:tokenTimeout*60*1000,max:tokenLimit,handler:function(req,res,next){return next(new RateLimitError(429,tokenLimit,tokenTimeout))},skipSuccessfulRequests:true});const newPasswordTimeout=5;const newPasswordLimit=5;const newPasswordLimiter=rateLimit({windowMs:newPasswordTimeout*60*1000,max:newPasswordLimit,handler:function(req,res,next){return next(new RateLimitError(429,newPasswordLimit,newPasswordTimeout))},skipSuccessfulRequests:true});export default{adminLimiter,genericPostLimiter,createCommentLimiter,genericCommentLimiter,createPostLimiter,authenticationLimiter,passwordResetLimiter,tokenLimiter,newPasswordLimiter,genericFriendLimiter,genericNotificationLimiter};
//# sourceMappingURL=rateLimiter.js.map