<spot-main-nav></spot-main-nav>
<div class="account">
  <div class="account-content">

    <div *ngIf="account$ | async as account; else noAccount">

      <div class="title">
        <span class="material-icons title-icon"> settings </span>
        {{ STRINGS.MY_ACCOUNT }}
      </div>

      <!-- Verification -->
      <div class="subheading" ngClass="{'mobile-column': account.verified_date == null}">
        <span class="subheading-text"> {{ STRINGS.EMAIL }} </span>
        <div *ngIf="account.verified_date == null; else verified">
          <div *ngIf="verificationSent == false; else sent" class="verify-click verify-container" (click)="verifyAccount()">
            <span class="verify-text"> {{ STRINGS.VERIFY }} </span>
            <span class="material-icons verify-icon"> email </span>
          </div>
          <ng-template #sent>
            <div class="verify-container">
              <span class="verify-text"> {{ STRINGS.VERIFY_SENT }} </span>
            </div>
          </ng-template>
        </div>
        <ng-template #verified>
          <div class="verify-container">
            <span class="verify-text"> {{ STRINGS.VERIFY_CHECK }} </span>
            <span class="material-icons verify-icon-highlight"> check_circle </span>
          </div>
        </ng-template>
      </div>

      <!-- Email -->
      <div class="value editable">
        <input #editEmail [disabled]="!editEmailEnabled" [(ngModel)]="email" type="text" spellcheck="false">
        <div *ngIf="editEmailEnabled; else elseEmailBlock">
          <span class="link" (click)="submitEditEmail()"> {{ STRINGS.SUBMIT }} </span>
        </div>
        <ng-template #elseEmailBlock>
          <span class="material-icons edit-icon" (click)="enableEditEmail()"> edit </span>
        </ng-template>
      </div>
      <div *ngIf="emailErrorMessage" class="error">
        {{ emailErrorMessage }}
      </div>
      <div *ngIf="emailSuccessMessage" class="success">
        {{ emailSuccessMessage }}
      </div>
      <div *ngIf="account.verified_date == null">
        <div class="description">
          {{ STRINGS.EMAIL_VERIFY_DESCRIPTION }}
        </div>
      </div>

      <!-- Username -->
      <div class="subheading"> {{ STRINGS.USERNAME }} </div>
      <div class="value editable">
        <input #editUsername [disabled]="!editUsernameEnabled" [(ngModel)]="username" type="text" spellcheck="false">
        <div *ngIf="editUsernameEnabled; else elseBlock">
          <span class="link" (click)="submitEditUsername()"> {{ STRINGS.SUBMIT }} </span>
        </div>
        <ng-template #elseBlock>
          <span class="material-icons edit-icon" (click)="enableEditUsername()"> edit </span>
        </ng-template>
      </div>
      <div *ngIf="usernameErrorMessage" class="error">
        {{ usernameErrorMessage }}
      </div>
      <div *ngIf="usernameSuccessMessage" class="success">
        {{ usernameSuccessMessage }}
      </div>

      <!-- Phone -->
      <div class="subheading"> {{ STRINGS.PHONE }} </div>
      <div class="value editable">
        <span *ngIf="!phone && !editPhoneEnabled" class="no-phone"> {{ STRINGS.NO_PHONE }} </span>
        <input #editPhone [disabled]="!editPhoneEnabled" [(ngModel)]="phone" type="text" spellcheck="false">
        <div *ngIf="editPhoneEnabled; else elsePhoneBlock">
          <span class="link" (click)="submitEditPhone()"> {{ STRINGS.SUBMIT }} </span>
        </div>
        <ng-template #elsePhoneBlock>
          <div *ngIf="phone; else add">
            <span class="material-icons edit-icon" (click)="enableEditPhone()"> edit </span>
          </div>
          <ng-template #add>
            <span class="link" (click)="enableEditPhone()"> {{ STRINGS.ADD }} </span>
          </ng-template>
        </ng-template>
      </div>
      <div *ngIf="phoneErrorMessage" class="error">
        {{ phoneErrorMessage }}
      </div>
      <div *ngIf="phoneSuccessMessage" class="success">
        {{ phoneSuccessMessage }}
      </div>

      <!-- Metadata properties -->
      <div *ngIf="accountMetadata$ | async as accountMetadata">

        <!-- Score -->
        <div class="subheading"> {{ STRINGS.SCORE }} </div>
        <div class="value"> <i class="material-icons hot"> whatshot </i> {{ accountMetadata.score }} </div>
        <div class="description"> {{ STRINGS.SCORE_DESCRIPTION }} </div>

        <!-- Unit -->
        <div class="subheading"> {{ STRINGS.UNIT }} </div>
        <div class="value">
          <div class="distance-button" [ngClass]="{'distance-selected': accountMetadata.distance_unit == 'imperial' }" (click)="setImperial()"> {{ STRINGS.IMPERIAL }} </div>
          <div class="distance-button" [ngClass]="{'distance-selected': accountMetadata.distance_unit == 'metric' }" (click)="setMetric()"> {{ STRINGS.METRIC }} </div>
        </div>

        <!-- Mature Content -->
        <div class="subheading"> {{ STRINGS.MATURE }} </div>
        <div class="value">
          <div class="distance-button" [ngClass]="{'distance-selected': accountMetadata.mature_filter == true }" (click)="setMature(true)"> {{ STRINGS.MATURE_TRUE }} </div>
          <div class="distance-button" [ngClass]="{'distance-selected': accountMetadata.mature_filter == false }" (click)="setMature(false)"> {{ STRINGS.MATURE_FALSE }} </div>
        </div>

      </div>

      <div class="title">
        <span class="material-icons title-icon"> people_alt </span>
        {{ STRINGS.SOCIAL }}
      </div>

      <div class="social">
        <div class="social-button" *ngIf="!(facebookConnected$ | async) && false; else facebookconnected">
          <button class="facebook" (click)="facebookConnect()">
            <img src="../../../assets/images/facebook_logo_white.png" class="facebook-logo">
            {{ STRINGS.FACEBOOK_CONNECT }}
          </button>
        </div>
        <ng-template #facebookconnected>
          <div class="facebook-connected">
            <img src="../../../assets/images/facebook_logo.png" class="facebook-logo">
            <span class="text"> Logged in with Facebook </span>
            <button (click)="facebookDisconnect()"> {{ STRINGS.FACEBOOK_CONNECT_SUCCESS }} </button>
          </div>
        </ng-template>
        <div class="social-button" *ngIf="!(googleConnected$ | async) && false; else googleconnected">
          <!-- GOOGLE -->
          <div id="my-signin2"></div>
        </div>
        <ng-template #googleconnected>
          <div class="google-connected">
            <img src="../../../assets/images/google_logo.png" class="google-logo">
            <span class="text"> Logged in with Google </span>
            <button (click)="googleDisconnect()"> {{ STRINGS.FACEBOOK_CONNECT_SUCCESS }} </button>
          </div>
        </ng-template>
      </div>
      <div class="description"> {{ STRINGS.FACEBOOK_CONNECT_DESCRIPTION }} </div>

      <div class="options">
        <div class="title">
          <span class="material-icons title-icon"> security </span>
          {{ STRINGS.ACCOUNT_OPTIONS }}
        </div>
        <label class="checkbox-container">
          <span class="enable-text"> {{ STRINGS.ENABLE_OPTIONS }} </span>
          <input type="checkbox" [(ngModel)]="accountOptionsEnabled">
          <span class="checkmark"> <span class="checkmark-inner"> </span> </span>
        </label>
      </div>
      <button class="delete" [ngClass]="{'disabled': !accountOptionsEnabled}" (click)="deleteUser()"> {{ STRINGS.DELETE }} </button>

    </div>

    <ng-template #noAccount>
      <div *ngIf="showAccountIndicator$ | async" class="no-account">
        <span class="material-icons icon"> person </span>
        <span class="text"> {{ STRINGS.NO_ACCOUNT }} </span>
      </div>
    </ng-template>

  </div>
</div>
