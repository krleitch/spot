<div class="container">
  <div class="post">
    <div class="left-bar">
      <i
        class="material-icons vote"
        (click)="like()"
        [ngClass]="{ highlight: spot.myRating === eSpotRatingType.LIKE }"
      >
        keyboard_arrow_up
      </i>
      <div class="points">{{ spot.likes - spot.dislikes }}</div>
      <i
        class="material-icons vote"
        (click)="dislike()"
        [ngClass]="{ highlight: spot.myRating === eSpotRatingType.DISLIKE }"
      >
        keyboard_arrow_down
      </i>
      <a class="time" [routerLink]="'/spot/' + spot.link">
        {{ time }}
      </a>
    </div>

    <div class="content-container">
      <!-- places beside to avoid extra space since style is whitespace: pre-wrap -->
      <div class="text">
        {{ getContent() }}
        <span *ngIf="isExpandable">
          <span *ngIf="expanded; else notExpanded">
            <span class="expand" (click)="setExpanded(false)">
              {{ 'MAIN.POST.SEE_LESS' | translate }}
            </span>
          </span>
          <ng-template #notExpanded>
            <span class="expand" (click)="setExpanded(true)">
              {{ 'MAIN.POST.SEE_MORE' | translate }}
            </span>
          </ng-template>
        </span>
      </div>

      <!-- Image -->
      <div
        *ngIf="spot.imageSrc !== null"
        (click)="imageClicked()"
        class="image"
      >
        <img
          #spotimage
          [src]="spot.imageSrc"
          [ngClass]="{
            'image-blur':
              (userMetadata === null && imageBlurred) ||
              (imageBlurred && userMetadata.matureFilter)
          }"
        />
        <div
          *ngIf="
            (userMetadata === null && imageBlurred) ||
            (imageBlurred && userMetadata.matureFilter)
          "
          class="image-blur-text"
        >
          <span class="material-icons icon"> error_outline </span>
          <span class="text"> {{ 'MAIN.POST.MATURE_CONTENT' | translate }} </span>
          <span class="text highlight">
            {{ 'MAIN.POST.MATURE_CONTENT_SHOW' | translate }}
          </span>
        </div>
      </div>

      <div class="options">
        <span class="comment-number">
          {{ spot.totalComments }}
          <span *ngIf="spot.totalComments === 1; else plural">
            {{ 'MAIN.POST.COMMENTS_SINGLE' | translate }}
          </span>
          <ng-template #plural>
            {{ 'MAIN.POST.COMMENTS' | translate }}
          </ng-template>
        </span>
        <div class="distance">
          <span *ngIf="spot.distance">
            {{ getDistance(spot.distance) }} -
          </span>
          {{ spot.geolocation }}
        </div>
      </div>
    </div>

    <div class="right-bar">
      <div #options>
        <i class="material-icons icon-size" (click)="setOptions(true)">
          more_horiz
        </i>
        <div class="dropdown align-bottom">
          <div class="dropdown-content" [ngClass]="{ show: optionsEnabled }">
            <a
              *ngIf="!detailed"
              class="button"
              [routerLink]="'/spot/' + spot.link"
            >
              <span class="material-icons icon"> chevron_right </span>
              {{ 'MAIN.POST.OPEN_POST' | translate }}
            </a>
            <div class="button" (click)="openReportModal(spot.spotId)">
              <span class="material-icons icon"> outlined_flag </span>
              {{ 'MAIN.POST.REPORT' | translate }}
            </div>
            <div
              class="button"
              (click)="openShareModal(spot.spotId, spot.link)"
            >
              <span class="material-icons icon"> share </span>
              {{ 'MAIN.POST.SHARE' | translate }}
            </div>
            <div
              *ngIf="
                spot.owned ||
                user.role === eUserRole.ADMIN ||
                user.role === eUserRole.OWNER
              "
              class="button"
              (click)="deleteSpot()"
            >
              <span class="material-icons icon"> delete </span>
              {{ 'MAIN.POST.DELETE' | translate }}
            </div>
          </div>
        </div>
      </div>

      <div>
        <i
          class="material-icons share"
          (click)="openShareModal(spot.spotId, spot.link)"
        >
          share
        </i>
      </div>
    </div>
  </div>

  <div class="bar-container">
    <div class="bar"></div>
  </div>

  <spot-comments-container
    [spot]="spot"
    [detailed]="detailed"
  ></spot-comments-container>
</div>
